import numpy as np
from pcmin import cape
from wrf import cape_2d, cape_3d
#
T = np.asarray([26.3,26.0,23.0,19.8,17.3,14.6,11.8,8.6,5.1,1.4,-2.5,-6.9,-11.9,\
      -17.7,-24.8,-33.2,-43.3,-55.2,-61.5,-67.6,-72.2,-73.5,-69.8,-63.9,-60.6,-57.3,-54.0])+273.15
Z = np.asarray([ 0.0000,132.0000,583.0000,1054.000,1547.000,2063.000,2609.000,\
      3182.000,3792.000,4442.000,5138.000,5888.000,6703.000,7595.000,\
      8581.000,9682.000,10935.00,12396.00,13236.00,14177.00,15260.00,\
      16568.00,17883.00,19620.00,20743.00,22139.00,23971.00])
P = np.asarray([1015.1,1000,  950,   900,   850,   800, 750, 700,  650,  600,  550,  500,  450,  400,  350,  300,  250,
        200,  175,  150,  125,  100,   80,   60,   50,   40,   30])
R = np.asarray([18.20,17.60,15.30,13.00,11.00,8.400,7.100,5.800,4.600,3.600,3.200,2.100,1.400,\
0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000]) * 1e-3
T = T.astype('float')
P = P.astype('float')
R = R.astype('float')
TP = T[0]
RP = R[0]
PP = P[0]
#
SIG = 0.0
print( cape(TP,RP,PP,T,R,P,SIG) )
TT=np.zeros([27,2,2])
ZZ=np.zeros([27,2,2])
PP=np.zeros([27,2,2])
RR=np.zeros([27,2,2])
for i in range(2):
   for j in range(2):
      TT[:,i,j]=T[:]
      ZZ[:,i,j]=Z[:]
      PP[:,i,j]=P[:]
      RR[:,i,j]=R[:]
TER_HEIGHT =  np.zeros([2,2])
TER_HEIGHT[:] = 0
SURF_P = np.zeros([2,2])
SURF_P[:] = 1015.1
cape,_,_,_=cape_2d(PP, TT, RR, ZZ, TER_HEIGHT, SURF_P, False)
cape,_  =cape_3d(P, T, R, Z, 0, 1015.1, False)
